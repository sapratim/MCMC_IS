mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta, covmat)
mala.is
px_mala <- px.mala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta, covmat)
# Asymptotic variance
asymp_covmat_is <- matrix(0, length(y), length(y))
asymp_covmat_pxm <- matrix(0, length(y), length(y))
is_samp <- matrix(unlist(mala.is[1]), nrow = iter, ncol = length(y))
is_wts <- as.numeric(unlist(mala.is[2]))
wts_mean <- mean(is_wts)
num <- is_samp*is_wts
sum_mat <- apply(num, 2, sum)
is_est <- sum_mat / sum(is_wts)
input_mat <- cbind(num, is_wts)  # input samples for mcse
Sigma_mat <- mcse.multi(input_mat)$cov  # estimated covariance matrix of the tuple
kappa_eta_mat <- cbind(diag(1/wts_mean, length(y)), is_est/wts_mean) # derivative of kappa matrix
asymp_covmat_is <- (kappa_eta_mat %*% Sigma_mat) %*% t(kappa_eta_mat)
# PxMALA asymptotic variance
asymp_covmat_pxm[i] <- mcse.multi(px_mala)$cov
asymp_covmat_pxm <- mcse.multi(px_mala)$cov
# Asymptotic variance comparison
var_mat <- cbind(det(asymp_covmat_is), det(asymp_covmat_pxm)) #asymp_covmat_pxb)
colnames(var_mat) <- c("Imp_sampling", "PxMala")
var_mat
asymp_covmat_is
source("IS_trendfiltering_functions.R")
iter <- 1e3
delta <- 0.0001
lamb_coeff <- 0.000001
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e4, delta = delta)[[2]]$cov
iter <- 1e3
delta <- 0.00007
lamb_coeff <- 0.000001
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e4, delta = delta)[[2]]$cov
delta <- 0.00005
lamb_coeff <- 0.000001
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e4, delta = delta)[[2]]$cov
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e4, delta = delta)[[2]]$cov
delta <- 0.00003
lamb_coeff <- 0.000001
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e4, delta = delta)[[2]]$cov
delta <- 0.00004
lamb_coeff <- 0.000001
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e4, delta = delta)[[2]]$cov
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta, covmat)
mala.is
px_mala <- px.mala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta, covmat)
px_mala
asymp_covmat_is <- matrix(0, length(y), length(y))
asymp_covmat_pxm <- matrix(0, length(y), length(y))
is_samp <- matrix(unlist(mala.is[1]), nrow = iter, ncol = length(y))
is_wts <- as.numeric(unlist(mala.is[2]))
wts_mean <- mean(is_wts)
num <- is_samp*is_wts
sum_mat <- apply(num, 2, sum)
is_est <- sum_mat / sum(is_wts)
input_mat <- cbind(num, is_wts)  # input samples for mcse
Sigma_mat <- mcse.multi(input_mat)$cov  # estimated covariance matrix of the tuple
kappa_eta_mat <- cbind(diag(1/wts_mean, length(y)), is_est/wts_mean) # derivative of kappa matrix
asymp_covmat_is <- (kappa_eta_mat %*% Sigma_mat) %*% t(kappa_eta_mat)
# PxMALA asymptotic variance
asymp_covmat_pxm <- mcse.multi(px_mala)$cov
# PxBarker asymptotic variance
# asymp_covmat_pxb[i] <- mcse.multi(px_bark)$cov
# Asymptotic variance comparison
var_mat <- cbind(det(asymp_covmat_is), det(asymp_covmat_pxm)) #asymp_covmat_pxb)
colnames(var_mat) <- c("Imp_sampling", "PxMala")
var_mat
source("IS_trendfiltering_functions.R")
iter <- 1e3
delta <- 0.00004
lamb_coeff <- 0.000001
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e4, delta = delta)[[2]]$cov
covmat
mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e4, delta = delta)
source("IS_trendfiltering_functions.R")
iter <- 1e3
delta <- 0.00004
lamb_coeff <- 0.000001
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e4, delta = delta)[[2]]
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta, covmat)
px_mala <- px.mala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta, covmat)
# Asymptotic variance
asymp_covmat_is <- matrix(0, length(y), length(y))
asymp_covmat_pxm <- matrix(0, length(y), length(y))
is_samp <- matrix(unlist(mala.is[1]), nrow = iter, ncol = length(y))
is_wts <- as.numeric(unlist(mala.is[2]))
wts_mean <- mean(is_wts)
num <- is_samp*is_wts
sum_mat <- apply(num, 2, sum)
is_est <- sum_mat / sum(is_wts)
input_mat <- cbind(num, is_wts)  # input samples for mcse
Sigma_mat <- mcse.multi(input_mat)$cov  # estimated covariance matrix of the tuple
kappa_eta_mat <- cbind(diag(1/wts_mean, length(y)), is_est/wts_mean) # derivative of kappa matrix
asymp_covmat_is <- (kappa_eta_mat %*% Sigma_mat) %*% t(kappa_eta_mat)
# PxMALA asymptotic variance
asymp_covmat_pxm <- mcse.multi(px_mala)$cov
# PxBarker asymptotic variance
# asymp_covmat_pxb[i] <- mcse.multi(px_bark)$cov
# Asymptotic variance comparison
var_mat <- cbind(det(asymp_covmat_is), det(asymp_covmat_pxm)) #asymp_covmat_pxb)
colnames(var_mat) <- c("Imp_sampling", "PxMala")
var_mat
mala.is
source("IS_trendfiltering_functions.R")
iter <- 1e3
delta <- 0.00004
lamb_coeff <- 0.000001
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e4, delta = delta)[[2]]
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta, covmat)
px_mala <- px.mala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta, covmat)
foo <- mala.is[[1]]
plot.ts(foo)
plot.ts(foo, 10)
source("IS_trendfiltering_functions.R")
iter <- 1e3
source("IS_trendfiltering_functions.R")
iter <- 1e3
delta <- 0.00004
lamb_coeff <- 0.000001
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e4, delta = delta)[[2]]
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta, covmat)
delta <- 0.000004
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta, covmat)
delta <- 0.0000004
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta, covmat)
lamb_coeff <- 0.001
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta, covmat)
delta <- 0.0000004
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta, covmat)
delta <- 0.00000000004
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta, covmat)
delta <- 0.000000004
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta, covmat)
delta <- 0.00000004
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta, covmat)
delta <- 0.00000003
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta, covmat)
lamb_coeff <- 0.000001
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta, covmat)
delta <- 0.00000003
lamb_coeff <- 0.000001
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta, covmat)
source("IS_trendfiltering_functions.R")
source("IS_trendfiltering_functions.R")
iter <- 1e3
delta <- 0.00004
lamb_coeff <- 0.000001
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
cormat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e4, delta = delta)[[2]]
source("IS_trendfiltering_functions.R")
iter <- 1e3
delta <- 0.00004
lamb_coeff <- 0.000001
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
cormat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e4, delta = delta)[[2]]
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta, cormat)
px_mala <- px.mala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta, cormat)
delta_samp <- 0.00000003
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, cormat)
px_mala <- px.mala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, cormat)
delta_samp <- 0.00000004
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, cormat)
delta_samp <- 0.000000035
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, cormat)
delta_samp <- 0.000000032
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, cormat)
px_mala <- px.mala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, cormat)
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, cormat)
px_mala <- px.mala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, cormat)
# Asymptotic variance
asymp_covmat_is <- matrix(0, length(y), length(y))
asymp_covmat_pxm <- matrix(0, length(y), length(y))
is_samp <- matrix(unlist(mala.is[1]), nrow = iter, ncol = length(y))
is_wts <- as.numeric(unlist(mala.is[2]))
wts_mean <- mean(is_wts)
num <- is_samp*is_wts
sum_mat <- apply(num, 2, sum)
is_est <- sum_mat / sum(is_wts)
input_mat <- cbind(num, is_wts)  # input samples for mcse
Sigma_mat <- mcse.multi(input_mat)$cov  # estimated covariance matrix of the tuple
kappa_eta_mat <- cbind(diag(1/wts_mean, length(y)), is_est/wts_mean) # derivative of kappa matrix
asymp_covmat_is <- (kappa_eta_mat %*% Sigma_mat) %*% t(kappa_eta_mat)
# PxMALA asymptotic variance
asymp_covmat_pxm <- mcse.multi(px_mala)$cov
# PxBarker asymptotic variance
# asymp_covmat_pxb[i] <- mcse.multi(px_bark)$cov
# Asymptotic variance comparison
var_mat <- cbind(det(asymp_covmat_is), det(asymp_covmat_pxm)) #asymp_covmat_pxb)
colnames(var_mat) <- c("Imp_sampling", "PxMala")
var_mat
rep(5, 10)
source("IS_trendfiltering_functions.R")
iter <- 1e3
delta <- 0.00004
lamb_coeff <- 0.000001
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e4, delta = delta)[[2]]
delta_samp <- 0.000000032
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
px_mala <- px.mala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
hist(mala.is[[2]])
hist(mala.is[[1]])
hist(mala.is[[2]])
delta_samp <- 0.00000004
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.00000008
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.0000008
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.000008
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.00008
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.000001
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.00005
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.00005
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
px_mala <- px.mala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.00008
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.00008
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.000001
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.000002
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.000005
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.00001
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.00001
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.00001
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.000005
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.000008
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.000008
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.0000085
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.000009
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.000009
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.00001
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.00001
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.000015
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.00002
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.00002
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
px_mala <- px.mala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.00002
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
px_mala <- px.mala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
hist(mala.is[[1]])
hist(mala.is[[2]])
ess(mala.is[[1]])
ess(px_mala[[1]])
ess(px_mala)
source("IS_trendfiltering_functions.R")
iter <- 1e3
delta <- 0.00004
lamb_coeff <- 0.000001
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e4, delta = delta)[[2]]
delta_samp <- 0.00002
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
px_mala <- px.mala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.00005
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
px_mala <- px.mala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.00008
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.00009
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
px_mala <- px.mala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.0001
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.0005
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.0002
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
px_mala <- px.mala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.0002
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
px_mala <- px.mala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
plot.ts(mala.is[[1]][1:10])
source("IS_trendfiltering_functions.R")
iter <- 1e3
delta <- 0.00004
lamb_coeff <- 0.000001
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e4, delta = delta)[[2]]
delta_samp <- 0.0002
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
px_mala <- px.mala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
plot.ts(mala.is[[1]][1:10])
plot.ts(mala.is[[1]])
plot.ts(mala.is[[1]][1])
plot.ts(mala.is[[1]][1:1e3])
plot.ts(mala.is[[1][1:6]])
plot.ts(mala.is[[1:6]])
plot.ts(mala.is[[1]])
ess(mala.is[[1]])
source("IS_trendfiltering_functions.R")
iter <- 1e5
delta <- 0.00004
lamb_coeff <- 0.000001
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e5, delta = delta)[[2]]
delta_samp <- 0.0002
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter= 1e3, delta = delta_samp, covmat)
source("IS_trendfiltering_functions.R")
delta_samp <- 0.0002
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter= 1e3, delta = delta_samp, covmat)
source("IS_trendfiltering_functions.R")
iter <- 1e5
delta <- 0.00004
lamb_coeff <- 0.000001
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e5, delta = delta)[[2]]
delta_samp <- 0.0002
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
px_mala <- px.mala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
hist(mala.is[[1]])
hist(mala.is[[2]])
plot.ts(mala.is[[1]])
plot.ts(mala.is[[1]][1:1e5])
plot.ts(mala.is[[1]][1:1e4])
plot.ts(mala.is[[1]][500:1e4])
plot.ts(mala.is[[1]][1000:1e4])
foo <- mala.is[[1]]
plot.ts(foo[,2])
plot.ts(foo[,2], foo[, 3])
plot.ts(foo[, 3])
plot.ts(foo[, c(2,3,4,5,6)])
plot.ts(foo[, c(1,2,3,4,5,6)][-500])
plot.ts(foo[, c(1,2,3,4,5,6)])
hist(mala.is[[2]])
source("IS_trendfiltering_functions.R")
iter <- 1e3
delta <- 0.00004
lamb_coeff <- 0.00001
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e3, delta = delta)[[2]]
delta_samp <- 0.0002
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
px_mala <- px.mala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
mala.is[[2]]
iter <- 1e3
delta <- 0.00004
lamb_coeff <- 0.000005
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e3, delta = delta)[[2]]
delta_samp <- 0.0002
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.00002
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.002
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
lamb_coeff <- 0.000005
delta_samp <- 0.002
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
px_mala <- px.mala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.005
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.003
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
lamb_coeff <- 0.000008
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e3, delta = delta)[[2]]
delta_samp <- 0.003
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
mala.is[[2]]
lamb_coeff <- 0.00001
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e3, delta = delta)[[2]]
delta_samp <- 0.003
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
mala.is[[2]]
lamb_coeff <- 0.000002
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e3, delta = delta)[[2]]
delta_samp <- 0.003
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
mala.is[[2]]
iter <- 1e3
delta <- 0.00004
lamb_coeff <- 0.000002
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e3, delta = delta)[[2]]
source("IS_trendfiltering_functions.R")
iter <- 1e3
delta <- 0.00004
lamb_coeff <- 0.000002
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e3, delta = delta)[[2]]
delta <- 0.00008
lamb_coeff <- 0.000002
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e3, delta = delta)[[2]]
delta_samp <- 0.003
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e3, delta = delta)[[2]]
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e3, delta = delta)[[2]]
delta <- 0.0001
lamb_coeff <- 0.000002
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e3, delta = delta)[[2]]
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e3, delta = delta)[[2]]
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e3, delta = delta)[[2]]
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e3, delta = delta)[[2]]
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e4, delta = delta)[[2]]
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e4, delta = delta)[[2]]
iter <- 1e3
delta <- 0.00005
lamb_coeff <- 0.000002
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e4, delta = delta)[[2]]
iter <- 1e3
delta <- 0.00005
lamb_coeff <- 0.000002
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e5, delta = delta)[[2]]
delta <- 0.00008
lamb_coeff <- 0.000002
D_mat <- getD(k=1, n=1e2, x)   #  D matrix
covmat <- mymala_cov_fn(y, alpha_hat, sigma2_hat, k=1, grid = x, iter = 1e5, delta = delta)[[2]]
delta_samp <- 0.003
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.0003
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.0005
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.0005
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.0008
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
px_mala <- px.mala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.0008
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter = 1e4, delta = delta_samp, covmat)
delta_samp <- 0.008
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter = 1e4, delta = delta_samp, covmat)
delta_samp <- 0.00008
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter = 1e4, delta = delta_samp, covmat)
delta_samp <- 0.0001
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter = 1e4, delta = delta_samp, covmat)
delta_samp <- 0.0003
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter = 1e4, delta = delta_samp, covmat)
delta_samp <- 0.00045
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter = 1e4, delta = delta_samp, covmat)
delta_samp <- 0.0004
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter = 1e4, delta = delta_samp, covmat)
delta_samp <- 0.00042
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter = 1e4, delta = delta_samp, covmat)
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter = 1e4, delta = delta_samp, covmat)
px_mala <- px.mala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter, delta = delta_samp, covmat)
delta_samp <- 0.00042
mala.is <- mymala(y, alpha_hat, sigma2_hat, k=1, grid=x, iter = 1e5, delta = delta_samp, covmat)
eigne
eigen(covmat)
eigen(covmat)$values
log(eigen(covmat)$values)
asymp_covmat_is <- matrix(0, length(y), length(y))
asymp_covmat_pxm <- matrix(0, length(y), length(y))
is_samp <- matrix(unlist(mala.is[1]), nrow = iter, ncol = length(y))
is_wts <- as.numeric(unlist(mala.is[2]))
wts_mean <- mean(is_wts)
num <- is_samp*is_wts
sum_mat <- apply(num, 2, sum)
is_est <- sum_mat / sum(is_wts)
input_mat <- cbind(num, is_wts)  # input samples for mcse
Sigma_mat <- mcse.multi(input_mat)$cov  # estimated covariance matrix of the tuple
kappa_eta_mat <- cbind(diag(1/wts_mean, length(y)), is_est/wts_mean) # derivative of kappa matrix
asymp_covmat_is <- (kappa_eta_mat %*% Sigma_mat) %*% t(kappa_eta_mat)
# PxMALA asymptotic variance
asymp_covmat_pxm <- mcse.multi(px_mala)$cov
# PxBarker asymptotic variance
# asymp_covmat_pxb[i] <- mcse.multi(px_bark)$cov
# Asymptotic variance comparison
var_mat <- cbind(sum(log(eigen(asymp_covmat_is)$values)),
sum(log(eigen(asymp_covmat_pxm)$values))) #asymp_covmat_pxb)
colnames(var_mat) <- c("Imp_sampling", "PxMala")
var_mat
foo <- mala.is[[1]]
plot.ts(foo[, c(1,2,3,4,5,6,7,8)])
