lines(abline(v=c(max(lamb[which(ess_ism_d5 >= 0.4)]), min(lamb[which(ess_ism_d5 <= 0.6)])),
col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
pdf(file = "ani_plot_d5.pdf", height = 8, width = 10)
par(mfrow = c(2,2))
plot(lamb_d5, ess_ism_d5, type = 'l', xlab = "lambda", ylab = "imp_ess",
main = "ESS for different lambda")
lines(abline(h=c(0.4,0.6), col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
lines(abline(v=c(max(lamb_d5[which(ess_ism_d5 >= 0.4)]), min(lamb_d5[which(ess_ism_d5 <= 0.6)])),
col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
plot(lamb_d5, asymp_var_pilam, type = 'l', xlab = "lambda", ylab = "asymptotic variance",
main = paste("Asymptotic variance  for pi^{lambda}"))
lines(abline(v=c(max(lamb_d5[which(ess_ism_d5 >= 0.4)]), min(lamb_d5[which(ess_ism_d5 <= 0.6)])),
col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
plot(lamb_d5, asymp_margvar_ism_d5, type = 'l', xlab = "lambda", ylab = "asymptotic variance",
main = "Asymptotic variance for different lambda")
lines(abline(v=c(max(lamb_d5[which(ess_ism_d5 >= 0.4)]), min(lamb_d5[which(ess_ism_d5 <= 0.6)])),
col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
dev.off()
d <- 5
beta <- seq(1, d, by = 1)
start <- rep(0.5, d)
mym.output <- mymala(beta, start, 1, 1e4, 0.04)
mym.output <- mymala(beta, start, 1, 1e4, 0.1)
mym.output <- mymala(beta, start, 1, 1e4, 0.5)
mym.output <- mymala(beta, start, 1, 1e4, 0.4)
mym.output <- mymala(beta, start, 1, 1e4, 0.25)
mym.output <- mymala(beta, start, 1, 1e4, 0.26)
mym.output <- mymala(beta, start, 1, 1e4, 0.26)
mym.output <- mymala(beta, start, 1, 1e4, 0.28)
mym.output <- mymala(beta, start, 1, 1e4, 0.28)
mym.output <- mymala(beta, start, 1, 1e4, 0.28)
mym.output <- mymala(beta, start, 1e-2, 1e4, 0.025)
pxm.output <- pxmala(beta, start, 1, 1e4, 0.025)
pxm.output <- pxmala(beta, start, 1, 1e4, 0.025)
pxm.output <- pxmala(beta, start, 1, 1e4, 0.02)
pxm.output <- pxmala(beta, start, 1, 1e4, 0.015)
pxm.output <- pxmala(beta, start, 1, 1e4, 0.015)
#####################################################################
########### Anisotropic Laplace output visualisation ################
#####################################################################
source("ani_laplace_functions.R")
library(mcmcse)
dimen_func <- function(d, lambda, iter, delta_is, delta_px)
{
beta <- seq(1, d, by = 1)
start <- rep(0.5, d)
mym.output <- mymala(beta, start, lambda, iter, delta_is)
pxm.output <- pxmala(beta, start, lambda, iter, delta_px)
output <- list(mym.output, pxm.output)
return(output)
}
iter <- 1e5
######################  dimension = 5  ################################
lamb_d5 <- seq(1e-2, 1, length = 50)
delta_is <- seq(0.025, 0.28, length = length(lamb_d5))
delta_px <- seq(0.025, 0.015, length = length(lamb_d5))
asymp_margvar_ism_d5 <- numeric(length = length(lamb_d5))
ess_ism_d5 <- numeric(length = length(lamb_d5))
asymp_var_pilam <- numeric(length = length(lamb_d5))
for (i in 1:length(lamb_d5))
{
output_mala_d5 <- dimen_func(d <- 5, lambda <- lamb_d5[i], iter <- iter, delta_is,
delta_px)
asymp_cov_ism_5 <- asymp_covmat_fn(output_mala_d5[[1]][[1]], exp(output_mala_d5[[1]][[2]]))
asymp_cov_pilam <- mcse.multi(output_mala_d5[[1]][[1]])$cov
asymp_cov_pxm_5 <- mcse.multi(output_mala_d5[[2]])$cov
asymp_margvar_ism_d5[i] <- mean(diag(asymp_cov_ism_5))   ####  Average asymptotic marginal variance
rel_eff_matrix_5 <- asymp_cov_pxm_5/asymp_cov_ism_5
asymp_var_pilam[i] <- mean(diag(asymp_cov_pilam))
wts <- exp(output_mala_d5[[1]][[2]])
ess_ism_d5[i] <- (mean(wts)^2)/mean(wts^2)
}
#####################################################################
########### Anisotropic Laplace output visualisation ################
#####################################################################
source("ani_laplace_functions.R")
library(mcmcse)
dimen_func <- function(d, lambda, iter, delta_is, delta_px)
{
beta <- seq(1, d, by = 1)
start <- rep(0.5, d)
mym.output <- mymala(beta, start, lambda, iter, delta_is)
pxm.output <- pxmala(beta, start, lambda, iter, delta_px)
output <- list(mym.output, pxm.output)
return(output)
}
iter <- 1e4
######################  dimension = 5  ################################
lamb_d5 <- seq(1e-2, 1, length = 50)
delta_is <- seq(0.025, 0.28, length = length(lamb_d5))
delta_px <- seq(0.025, 0.015, length = length(lamb_d5))
asymp_margvar_ism_d5 <- numeric(length = length(lamb_d5))
ess_ism_d5 <- numeric(length = length(lamb_d5))
asymp_var_pilam <- numeric(length = length(lamb_d5))
for (i in 1:length(lamb_d5))
{
output_mala_d5 <- dimen_func(d <- 5, lambda <- lamb_d5[i], iter <- iter, delta_is,
delta_px)
asymp_cov_ism_5 <- asymp_covmat_fn(output_mala_d5[[1]][[1]], exp(output_mala_d5[[1]][[2]]))
asymp_cov_pilam <- mcse.multi(output_mala_d5[[1]][[1]])$cov
asymp_cov_pxm_5 <- mcse.multi(output_mala_d5[[2]])$cov
asymp_margvar_ism_d5[i] <- mean(diag(asymp_cov_ism_5))   ####  Average asymptotic marginal variance
rel_eff_matrix_5 <- asymp_cov_pxm_5/asymp_cov_ism_5
asymp_var_pilam[i] <- mean(diag(asymp_cov_pilam))
wts <- exp(output_mala_d5[[1]][[2]])
ess_ism_d5[i] <- (mean(wts)^2)/mean(wts^2)
}
#####################################################################
########### Anisotropic Laplace output visualisation ################
#####################################################################
source("ani_laplace_functions.R")
library(mcmcse)
dimen_func <- function(d, lambda, iter, delta_is, delta_px)
{
beta <- seq(1, d, by = 1)
start <- rep(0.5, d)
mym.output <- mymala(beta, start, lambda, iter, delta_is)
pxm.output <- pxmala(beta, start, lambda, iter, delta_px)
output <- list(mym.output, pxm.output)
return(output)
}
iter <- 1e5
######################  dimension = 5  ################################
lamb_d5 <- seq(1e-2, 1, length = 50)
delta_is <- seq(0.025, 0.28, length = length(lamb_d5))
delta_px <- seq(0.025, 0.015, length = length(lamb_d5))
asymp_margvar_ism_d5 <- numeric(length = length(lamb_d5))
ess_ism_d5 <- numeric(length = length(lamb_d5))
asymp_var_pilam <- numeric(length = length(lamb_d5))
for (i in 1:length(lamb_d5))
{
output_mala_d5 <- dimen_func(d <- 5, lambda <- lamb_d5[i], iter <- iter, delta_is[i],
delta_px[i])
asymp_cov_ism_5 <- asymp_covmat_fn(output_mala_d5[[1]][[1]], exp(output_mala_d5[[1]][[2]]))
asymp_cov_pilam <- mcse.multi(output_mala_d5[[1]][[1]])$cov
asymp_cov_pxm_5 <- mcse.multi(output_mala_d5[[2]])$cov
asymp_margvar_ism_d5[i] <- mean(diag(asymp_cov_ism_5))   ####  Average asymptotic marginal variance
rel_eff_matrix_5 <- asymp_cov_pxm_5/asymp_cov_ism_5
asymp_var_pilam[i] <- mean(diag(asymp_cov_pilam))
wts <- exp(output_mala_d5[[1]][[2]])
ess_ism_d5[i] <- (mean(wts)^2)/mean(wts^2)
}
pdf(file = "ani_plot_d5.pdf", height = 8, width = 10)
par(mfrow = c(2,2))
plot(lamb_d5, ess_ism_d5, type = 'l', xlab = "lambda", ylab = "imp_ess",
main = "ESS for different lambda")
lines(abline(h=c(0.4,0.6), col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
lines(abline(v=c(max(lamb_d5[which(ess_ism_d5 >= 0.4)]), min(lamb_d5[which(ess_ism_d5 <= 0.6)])),
col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
plot(lamb_d5, asymp_var_pilam, type = 'l', xlab = "lambda", ylab = "asymptotic variance",
main = paste("Asymptotic variance  for pi^{lambda}"))
lines(abline(v=c(max(lamb_d5[which(ess_ism_d5 >= 0.4)]), min(lamb_d5[which(ess_ism_d5 <= 0.6)])),
col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
plot(lamb_d5, asymp_margvar_ism_d5, type = 'l', xlab = "lambda", ylab = "asymptotic variance",
main = "Asymptotic variance for different lambda")
lines(abline(v=c(max(lamb_d5[which(ess_ism_d5 >= 0.4)]), min(lamb_d5[which(ess_ism_d5 <= 0.6)])),
col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
dev.off()
pdf(file = "ani_plot_d5.pdf", height = 8, width = 10)
par(mfrow = c(2,2))
plot(lamb_d5, ess_ism_d5, type = 'l', xlab = "lambda", ylab = "imp_ess",
main = "ESS for different lambda")
lines(abline(h=c(0.4,0.6), col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
lines(abline(v=c(max(lamb_d5[which(ess_ism_d5 >= 0.4)]), min(lamb_d5[which(ess_ism_d5 <= 0.6)])),
col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
plot(lamb_d5, asymp_var_pilam, type = 'l', xlab = "lambda", ylab = "asymptotic variance",
main = paste("Asymptotic variance  for pi^{lambda}"))
lines(abline(v=c(max(lamb_d5[which(ess_ism_d5 >= 0.4)]), min(lamb_d5[which(ess_ism_d5 <= 0.6)])),
col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
plot(lamb_d5, asymp_margvar_ism_d5, type = 'l', xlab = "lambda", ylab = "asymptotic variance",
main = "Asymptotic variance for pi based on IS estimator")
lines(abline(v=c(max(lamb_d5[which(ess_ism_d5 >= 0.4)]), min(lamb_d5[which(ess_ism_d5 <= 0.6)])),
col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
dev.off()
1e-3/5
1e-2/5
d <- 5-
s\
d <- 50
beta <- seq(1, d, by = 1)
start <- rep(0.5, d)
mym.output <- mymala(beta, start, 2e-3, 1e4, 0.002)
mym.output <- mymala(beta, start, 2e-3, 1e4, 0.0002)
mym.output <- mymala(beta, start, 2e-3, 1e4, 0.00004)
mym.output <- mymala(beta, start, 2e-3, 1e4, 0.00002)
mym.output <- mymala(beta, start, 2e-3, 1e4, 0.00002)
mym.output <- mymala(beta, start, 0.2, 1e4, 0.01)
mym.output <- mymala(beta, start, 0.2, 1e4, 0.0001)
mym.output <- mymala(beta, start, 0.2, 1e4, 0.00015)
mym.output <- mymala(beta, start, 0.2, 1e4, 0.00015)
mym.output <- mymala(beta, start, 0.2, 1e4, 0.00012)
mym.output <- mymala(beta, start, 0.2, 1e4, 0.00012)
pxm.output <- pxmala(beta, start, 2e-3, 1e4, 0.00002)
pxm.output <- pxmala(beta, start, 2e-3, 1e4, 0.00002)
pxm.output <- pxmala(beta, start, 0.2, 1e4, 0.00001)
pxm.output <- pxmala(beta, start, 0.2, 1e4, 0.00002)
pxm.output <- pxmala(beta, start, 0.2, 1e4, 0.00002)
pxm.output <- pxmala(beta, start, 0.2, 1e4, 0.000018)
pxm.output <- pxmala(beta, start, 0.2, 1e4, 0.000018)
#####################################################################
########### Anisotropic Laplace output visualisation ################
#####################################################################
source("ani_laplace_functions.R")
library(mcmcse)
dimen_func <- function(d, lambda, iter, delta_is, delta_px)
{
beta <- seq(1, d, by = 1)
start <- rep(0.5, d)
mym.output <- mymala(beta, start, lambda, iter, delta_is)
pxm.output <- pxmala(beta, start, lambda, iter, delta_px)
output <- list(mym.output, pxm.output)
return(output)
}
iter <- 1e4
lamb_d50 <- seq(2e-3, 0.2, length = 50)
delta_is <- seq(0.00002, 0.00012, length = 1e2)
delta_px <- seq(0.00002, 0.000018, length = 1e2)
asymp_margvar_ism_d50 <- numeric(length = length(lamb))
iter <- 1e4
lamb_d50 <- seq(2e-3, 0.2, length = 50)
delta_is <- seq(0.00002, 0.00012, length = 1e2)
delta_px <- seq(0.00002, 0.000018, length = 1e2)
asymp_margvar_ism_d50 <- numeric(length = length(lamb_d50))
ess_ism_d50 <- numeric(length = length(lamb_d50))
asymp_var_pilam_d50 <- numeric(length = length(lamb_d50))
for (i in 1:length(lamb))
{
output_mala_d50 <- dimen_func(d <- 50, lambda <- lamb_d50[i], iter <- iter, delta_is[i],
delta_px[i])
asymp_cov_ism_50 <- asymp_covmat_fn(output_mala_d50[[1]][[1]], exp(output_mala_d50[[1]][[2]]))
asymp_cov_pilam_d50 <- mcse.multi(output_mala_d50[[1]][[1]])$cov
asymp_cov_pxm_50 <- mcse.multi(output_mala_d50[[2]])$cov
asymp_margvar_ism_d50[i] <- mean(diag(asymp_cov_ism_50))   ####  Average asymptotic marginal variance
rel_eff_matrix_50 <- asymp_cov_pxm_50/asymp_cov_ism_50
asymp_var_pilam_d50[i] <- mean(diag(asymp_cov_pilam_d50))
wts <- exp(output_mala_d50[[1]][[2]])
ess_ism_d50[i] <- (mean(wts)^2)/mean(wts^2)
}
iter <- 1e4
lamb_d50 <- seq(2e-3, 0.2, length = 50)
delta_is <- seq(0.00002, 0.00012, length = 1e2)
delta_px <- seq(0.00002, 0.000018, length = 1e2)
asymp_margvar_ism_d50 <- numeric(length = length(lamb_d50))
ess_ism_d50 <- numeric(length = length(lamb_d50))
asymp_var_pilam_d50 <- numeric(length = length(lamb_d50))
for (i in 1:length(lamb_d50))
{
output_mala_d50 <- dimen_func(d <- 50, lambda <- lamb_d50[i], iter <- iter, delta_is[i],
delta_px[i])
asymp_cov_ism_50 <- asymp_covmat_fn(output_mala_d50[[1]][[1]], exp(output_mala_d50[[1]][[2]]))
asymp_cov_pilam_d50 <- mcse.multi(output_mala_d50[[1]][[1]])$cov
asymp_cov_pxm_50 <- mcse.multi(output_mala_d50[[2]])$cov
asymp_margvar_ism_d50[i] <- mean(diag(asymp_cov_ism_50))   ####  Average asymptotic marginal variance
rel_eff_matrix_50 <- asymp_cov_pxm_50/asymp_cov_ism_50
asymp_var_pilam_d50[i] <- mean(diag(asymp_cov_pilam_d50))
wts <- exp(output_mala_d50[[1]][[2]])
ess_ism_d50[i] <- (mean(wts)^2)/mean(wts^2)
}
warnings()
plot(lamb_d50, ess_ism_d50, type = 'l', xlab = "lambda", ylab = "imp_ess",
main = "ESS for different lambda")
lines(abline(h=c(0.4,0.6), col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
lines(abline(v=c(max(lamb_d50[which(ess_ism_d50 >= 0.4)]), min(lamb_d50[which(ess_ism_d50 <= 0.6)])),
col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
plot(lamb, asymp_var_pilam_d50, type = 'l', xlab = "lambda", ylab = "asymptotic variance",
main = "Asymptotic variance for pi^{lambda}")
pdf(file = "ani_plot_d50.pdf", height = 8, width = 10)
par(mfrow = c(2,2))
plot(lamb_d50, ess_ism_d50, type = 'l', xlab = "lambda", ylab = "imp_ess",
main = "ESS for different lambda")
lines(abline(h=c(0.4,0.6), col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
lines(abline(v=c(max(lamb_d50[which(ess_ism_d50 >= 0.4)]), min(lamb_d50[which(ess_ism_d50 <= 0.6)])),
col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
plot(lamb, asymp_var_pilam_d50, type = 'l', xlab = "lambda", ylab = "asymptotic variance",
main = "Asymptotic variance for pi^{lambda}")
pdf(file = "ani_plot_d50.pdf", height = 8, width = 10)
par(mfrow = c(2,2))
plot(lamb_d50, ess_ism_d50, type = 'l', xlab = "lambda", ylab = "imp_ess",
main = "ESS for different lambda")
lines(abline(h=c(0.4,0.6), col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
lines(abline(v=c(max(lamb_d50[which(ess_ism_d50 >= 0.4)]), min(lamb_d50[which(ess_ism_d50 <= 0.6)])),
col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
plot(lamb_d50, asymp_var_pilam_d50, type = 'l', xlab = "lambda", ylab = "asymptotic variance",
main = "Asymptotic variance for pi^{lambda}")
lines(abline(v=c(max(lamb_d50[which(ess_ism_d50 >= 0.4)]), min(lamb_d50[which(ess_ism_d50 <= 0.6)])),
col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
plot(lamb_d50, asymp_margvar_ism_d50, type = 'l', xlab = "lambda", ylab = "asymptotic variance",
main = "Asymptotic variance for pi based on IS estimator")
lines(abline(v=c(max(lamb_d50[which(ess_ism_d50 >= 0.4)]), min(lamb_d50[which(ess_ism_d50 <= 0.6)])),
col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
dev.off()
iter <- 1e5
lamb_d50 <- seq(2e-3, 0.2, length = 50)
delta_is <- seq(0.00002, 0.00012, length = 1e2)
delta_px <- seq(0.00002, 0.000018, length = 1e2)
asymp_margvar_ism_d50 <- numeric(length = length(lamb_d50))
ess_ism_d50 <- numeric(length = length(lamb_d50))
asymp_var_pilam_d50 <- numeric(length = length(lamb_d50))
for (i in 1:length(lamb_d50))
{
output_mala_d50 <- dimen_func(d <- 50, lambda <- lamb_d50[i], iter <- iter, delta_is[i],
delta_px[i])
asymp_cov_ism_50 <- asymp_covmat_fn(output_mala_d50[[1]][[1]], exp(output_mala_d50[[1]][[2]]))
asymp_cov_pilam_d50 <- mcse.multi(output_mala_d50[[1]][[1]])$cov
asymp_cov_pxm_50 <- mcse.multi(output_mala_d50[[2]])$cov
asymp_margvar_ism_d50[i] <- mean(diag(asymp_cov_ism_50))   ####  Average asymptotic marginal variance
rel_eff_matrix_50 <- asymp_cov_pxm_50/asymp_cov_ism_50
asymp_var_pilam_d50[i] <- mean(diag(asymp_cov_pilam_d50))
wts <- exp(output_mala_d50[[1]][[2]])
ess_ism_d50[i] <- (mean(wts)^2)/mean(wts^2)
}
warnings()
pdf(file = "ani_plot_d50.pdf", height = 8, width = 10)
par(mfrow = c(2,2))
plot(lamb_d50, ess_ism_d50, type = 'l', xlab = "lambda", ylab = "imp_ess",
main = "ESS for different lambda")
lines(abline(h=c(0.4,0.6), col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
lines(abline(v=c(max(lamb_d50[which(ess_ism_d50 >= 0.4)]), min(lamb_d50[which(ess_ism_d50 <= 0.6)])),
col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
plot(lamb_d50, asymp_var_pilam_d50, type = 'l', xlab = "lambda", ylab = "asymptotic variance",
main = "Asymptotic variance for pi^{lambda}")
lines(abline(v=c(max(lamb_d50[which(ess_ism_d50 >= 0.4)]), min(lamb_d50[which(ess_ism_d50 <= 0.6)])),
col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
plot(lamb_d50, asymp_margvar_ism_d50, type = 'l', xlab = "lambda", ylab = "asymptotic variance",
main = "Asymptotic variance for pi based on IS estimator")
lines(abline(v=c(max(lamb_d50[which(ess_ism_d50 >= 0.4)]), min(lamb_d50[which(ess_ism_d50 <= 0.6)])),
col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
dev.off()
pdf(file = "ani_plot_d50.pdf", height = 8, width = 10)
par(mfrow = c(2,2))
plot(lamb_d50, ess_ism_d50, type = 'l', xlab = "lambda", ylab = "imp_ess",
main = "ESS for different lambda")
lines(abline(h=c(0.4,0.6), col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
lines(abline(v=c(max(lamb_d50[which(ess_ism_d50 >= 0.4)]), min(lamb_d50[which(ess_ism_d50 <= 0.6)])),
col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
plot(lamb_d50, asymp_var_pilam_d50, type = 'l', xlab = "lambda", ylab = "asymptotic variance",
main = "Asymptotic variance for pi^{lambda}")
lines(abline(v=c(max(lamb_d50[which(ess_ism_d50 >= 0.4)]), min(lamb_d50[which(ess_ism_d50 <= 0.6)])),
col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
plot(lamb_d50, asymp_margvar_ism_d50, type = 'l', xlab = "lambda", ylab = "asymptotic variance",
main = "Asymptotic variance for pi based on IS estimator")
lines(abline(v=c(max(lamb_d50[which(ess_ism_d50 >= 0.4)]), min(lamb_d50[which(ess_ism_d50 <= 0.6)])),
col=c("blue", "red"), lty=c(2,2), lwd=c(1, 1)))
dev.off()
ess_ism_d50
lamb_d50[which(ess_ism_d50 >= 0.4)]
max(lamb_d50[which(ess_ism_d50 >= 0.4)]
)
min(lamb_d50[which(ess_ism_d50 <= 0.6)]))
min(lamb_d50[which(ess_ism_d50 <= 0.6)])
lamb_d50[which(ess_ism_d50 <= 0.6)]
d <- 50
beta <- seq(1, d, by = 1)
beta
source("ani_laplace_functions.R")
d<- 10
beta <- seq(1, d, by = 1)
start <- rep(0.5, d)
mym.output <- mymala(beta, start, 1e-2, 1e4, 0.002)
mym.output <- mymala(beta, start, lambda <- 1e-2, 1e4, 0.002)
mym.output <- mymala(beta, start, lambda <- 1e-2, 1e4, 0.002)
mym.output <- mymala(beta, start, lambda <- 1e-2, 1e4, 0.0025)
mym.output <- mymala(beta, start, lambda <- 1e-2, 1e4, 0.0025)
mym.output <- mymala(beta, start, lambda <- 1e-2, 1e4, 0.0025)
d
d
mym.output <- mymala(beta, start, lambda <- 1e-2, 1e4, 0.0025)
mym.output <- mymala(beta, start, lambda <- 0.5, 1e4, 0.25)
mym.output <- mymala(beta, start, lambda <- 0.5, 1e4, 0.025)
mym.output <- mymala(beta, start, lambda <- 0.5, 1e4, 0.02)
mym.output <- mymala(beta, start, lambda <- 0.5, 1e4, 0.018)
mym.output <- mymala(beta, start, lambda <- 0.5, 1e4, 0.018)
mym.output <- mymala(beta, start, lambda <- 0.5, 1e4, 0.018)
mym.output <- mymala(beta, start, lambda <- 0.5, 1e4, 0.018)
pxm.output <- pxmala(beta, start, 1e-2, 1e4, 0.0025)
pxm.output <- pxmala(beta, start, 1e-2, 1e4, 0.0025)
pxm.output <- pxmala(beta, start, 0.5, 1e4, 0.0025)
pxm.output <- pxmala(beta, start, 0.5, 1e4, 0.0018)
pxm.output <- pxmala(beta, start, 0.5, 1e4, 0.0018)
pxm.output <- pxmala(beta, start, 0.5, 1e4, 0.0018)
pxm.output <- pxmala(beta, start, 0.5, 1e4, 0.0018)
pxm.output <- pxmala(beta, start, 0.5, 1e4, 0.0018)
pxm.output <- pxmala(beta, start, 0.5, 1e4, 0.0019)
pxm.output <- pxmala(beta, start, 0.5, 1e4, 0.0019)
pxm.output <- pxmala(beta, start, 0.5, 1e4, 0.0019)
d <- 20
beta <- seq(1, d, by = 1)
start <- rep(0.5, d)
mym.output <- mymala(beta, start, 5e-3, 1e4, 0.002)
mym.output <- mymala(beta, start, 5e-3, 1e4, 0.0005)
mym.output <- mymala(beta, start, 5e-3, 1e4, 0.0003)
mym.output <- mymala(beta, start, 5e-3, 1e4, 0.0003)
mym.output <- mymala(beta, start, 5e-3, 1e4, 0.0003)
mym.output <- mymala(beta, start, 0.1, 1e4, 0.0003)
mym.output <- mymala(beta, start, 0.1, 1e4, 0.0004)
mym.output <- mymala(beta, start, 0.1, 1e4, 0.0006)
mym.output <- mymala(beta, start, 0.1, 1e4, 0.0007)
mym.output <- mymala(beta, start, 0.1, 1e4, 0.0007)
pxm.output <- pxmala(beta, start, 5e-3, 1e4, 0.0003)
pxm.output <- pxmala(beta, start, 5e-3, 1e4, 0.0003)
pxm.output <- pxmala(beta, start, 5e-3, 1e4, 0.0003)
pxm.output <- pxmala(beta, start, 5e-3, 1e4, 0.0003)
pxm.output <- pxmala(beta, start, 0.1, 1e4, 0.0001)
pxm.output <- pxmala(beta, start, 0.1, 1e4, 0.000)
pxm.output <- pxmala(beta, start, 0.1, 1e4, 0.0002)
pxm.output <- pxmala(beta, start, 0.1, 1e4, 0.00025)
pxm.output <- pxmala(beta, start, 0.1, 1e4, 0.00025)
pxm.output <- pxmala(beta, start, 0.1, 1e4, 0.00025)
d <- 50
beta <- seq(1, d, by = 1)
start <- rep(0.5, d)
mym.output <- mymala(beta, start, 0.05, 1e4, 0.0004)
mym.output <- mymala(beta, start, 0.05, 1e4, 0.0001)
mym.output <- mymala(beta, start, 0.05, 1e4, 0.00005)
mym.output <- mymala(beta, start, 0.05, 1e4, 0.00005)
pxm.output <- pxmala(beta, start, 0.05, 1e4, 0.0001)
pxm.output <- pxmala(beta, start, 0.05, 1e4, 0.00001)
pxm.output <- pxmala(beta, start, 0.05, 1e4, 0.00002)
pxm.output <- pxmala(beta, start, 0.05, 1e4, 0.000015)
pxm.output <- pxmala(beta, start, 0.05, 1e4, 0.000017)
pxm.output <- pxmala(beta, start, 0.05, 1e4, 0.000018)
#####################################################################
########### Anisotropic Laplace output visualisation ################
#####################################################################
source("ani_laplace_functions.R")
library(mcmcse)
iter <- 1e3
######################  dimension = 5  ################################
lamb_d5 <- seq(1e-2, 1, length = 1e2)
delta_is <- seq(0.025, 0.28, length = length(lamb_d5))
delta_px <- seq(0.025, 0.015, length = length(lamb_d5))
asymp_margvar_ism_d5 <- numeric(length = length(lamb_d5))
ess_ism_d5 <- numeric(length = length(lamb_d5))
asymp_var_pilam_d5 <- numeric(length = length(lamb_d5))
for (i in 1:length(lamb_d5))
{
output_mala_d5 <- dimen_func(d <- 5, lambda <- lamb_d5[i], iter <- iter, delta_is[i],
delta_px[i])
asymp_cov_ism_5 <- asymp_covmat_fn(output_mala_d5[[1]][[1]], exp(output_mala_d5[[1]][[2]]))
asymp_cov_pilam_d5 <- mcse.multi(output_mala_d5[[1]][[1]])$cov
asymp_cov_pxm_5 <- mcse.multi(output_mala_d5[[2]])$cov
asymp_margvar_ism_d5[i] <- mean(diag(asymp_cov_ism_5))   ####  Average asymptotic marginal variance
asymp_var_pilam_d5[i] <- mean(diag(asymp_cov_pilam_d5))
wts <- exp(output_mala_d5[[1]][[2]])
ess_ism_d5[i] <- (mean(wts)^2)/mean(wts^2)
}
output_d5 <- list(asymp_margvar_ism_d5, ess_ism_d5, asymp_var_pilam_d5)
######################  dimension = 10  ##############################
lamb_d10 <- seq(1e-2, 0.5, length = 1e2)
delta_is <- seq(0.0025, 0.018, length = 1e2)
delta_px <- seq(0.0025, 0.0019, length = 1e2)
asymp_margvar_ism_d10 <- numeric(length = length(lamb_d10))
ess_ism_d10 <- numeric(length = length(lamb_d10))
asymp_var_pilam_d10 <- numeric(length = length(lamb_d10))
for (i in 1:length(lamb_d10))
{
output_mala_d10 <- dimen_func(d <- 10, lambda <- lamb_d10[i], iter <- iter, delta_is[i],
delta_px[i])
asymp_cov_ism_10 <- asymp_covmat_fn(output_mala_d10[[1]][[1]], exp(output_mala_d10[[1]][[2]]))
asymp_cov_pilam_d10 <- mcse.multi(output_mala_d10[[1]][[1]])$cov
asymp_cov_pxm_10 <- mcse.multi(output_mala_d10[[2]])$cov
asymp_margvar_ism_d10[i] <- mean(diag(asymp_cov_ism_10))   ####  Average asymptotic marginal variance
asymp_var_pilam_d10[i] <- mean(diag(asymp_cov_pilam_d10))
wts <- exp(output_mala_d10[[1]][[2]])
ess_ism_d10[i] <- (mean(wts)^2)/mean(wts^2)
}
output_d10 <- list(asymp_margvar_ism_d10, ess_ism_d10, asymp_var_pilam_d10)
######################  dimension = 20  ##############################
lamb_d20 <- seq(5e-3, 0.1, length = 1e2)
delta_is <- seq(0.0003, 0.0007, length = 1e2)
delta_px <- seq(0.0003, 0.00025, length = 1e2)
asymp_margvar_ism_d20 <- numeric(length = length(lamb_d20))
ess_ism_d20 <- numeric(length = length(lamb_d20))
asymp_var_pilam_d20 <- numeric(length = length(lamb_d20))
for (i in 1:length(lamb_d20))
{
output_mala_d20 <- dimen_func(d <- 20, lambda <- lamb_d20[i], iter <- iter, delta_is[i],
delta_px[i])
asymp_cov_ism_20 <- asymp_covmat_fn(output_mala_d20[[1]][[1]], exp(output_mala_d20[[1]][[2]]))
asymp_cov_pilam_d20 <- mcse.multi(output_mala_d20[[1]][[1]])$cov
asymp_cov_pxm_20 <- mcse.multi(output_mala_d20[[2]])$cov
asymp_margvar_ism_d20[i] <- mean(diag(asymp_cov_ism_20))   ####  Average asymptotic marginal variance
asymp_var_pilam_d20[i] <- mean(diag(asymp_cov_pilam_d20))
wts <- exp(output_mala_d20[[1]][[2]])
ess_ism_d20[i] <- (mean(wts)^2)/mean(wts^2)
}
output_d20 <- list(asymp_margvar_ism_d20, ess_ism_d20, asymp_var_pilam_d20)
######################  dimension = 50  ##############################
lamb_d50 <- seq(1e-3, 0.05, length = 1e2)
delta_is <- seq(0.00002, 0.00005, length = 1e2)
delta_px <- seq(0.00002, 0.000018, length = 1e2)
asymp_margvar_ism_d50 <- numeric(length = length(lamb_d50))
ess_ism_d50 <- numeric(length = length(lamb_d50))
asymp_var_pilam_d50 <- numeric(length = length(lamb_d50))
for (i in 1:length(lamb_d50))
{
output_mala_d50 <- dimen_func(d <- 50, lambda <- lamb_d50[i], iter <- iter, delta_is[i],
delta_px[i])
asymp_cov_ism_50 <- asymp_covmat_fn(output_mala_d50[[1]][[1]], exp(output_mala_d50[[1]][[2]]))
asymp_cov_pilam_d50 <- mcse.multi(output_mala_d50[[1]][[1]])$cov
asymp_cov_pxm_50 <- mcse.multi(output_mala_d50[[2]])$cov
asymp_margvar_ism_d50[i] <- mean(diag(asymp_cov_ism_50))   ####  Average asymptotic marginal variance
rel_eff_matrix_50 <- asymp_cov_pxm_50/asymp_cov_ism_50
asymp_var_pilam_d50[i] <- mean(diag(asymp_cov_pilam_d50))
wts <- exp(output_mala_d50[[1]][[2]])
ess_ism_d50[i] <- (mean(wts)^2)/mean(wts^2)
}
output_d50 <- list(asymp_margvar_ism_d50, ess_ism_d50, asymp_var_pilam_d50)
output <- list(output_d5, output_d10, output_d20, output_d50)
output[[1]][[1]]
output[[1]][[2]]
output[[1]][[3]]
